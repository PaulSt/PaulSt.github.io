Title: Quasi-Trefftz DG for the wave equation
Date:  2021-09-07

We consider the wave operator

$$
\begin{align*} \begin{split}
(\square_G f)(\mathbf{x},t):= \Delta f(\mathbf{x},t)-G(\mathbf{x})\partial_t^2 f(\mathbf{x},t).
\end{split} \end{align*}
$$

with smooth coefficient $G(\mathbf{x})$. 
Constructing a basis for a traditional Trefftz space (i.e. a space of functions with $\square_G f=0$) is not possible.
The crucial idea is that we want to relax the Trefftz porperty to 

$$\square_G f=\mathcal{O}(\|(\mathbf{x},t)-(\mathbf{x}_K,t_K)\|^q), $$

with respect to the center of a mesh element $K$ and up to some $q$.
This leads to the definition of a new *quasi-Trefftz* space: For an element $K$ in a space-time mesh let

$$
\begin{align*} \begin{split}
\mathbb{T}^p(K):=\big\{
f\in\mathbb{P}^p(K) \ \mid&\ D^{i}\square_G f(\mathbf{x}_K,t_K)=0,\\ &\forall i\in \mathbb{N}^{n+1}_0, |i|<p-1
\big\},
\end{split} \end{align*}
$$

For this space we are able to construct a basis. 
We then introduce a space-time DG method with test and trial functions that are locally quasi-Trefftz. 
The example below shows an acoustic wave propagating through a material with $G(x,y)=y+1$ and homogeneous Neumann boundary conditions. 

# ![qtrefftz](/images/qtrefftzdg.gif) *Wave propagation in inhomogeneous material using quasi-Trefftz DG*
